#!/bin/bash
wd=$1 #'/home/joel/sim/topomap_points/'
source $wd/toposat.ini
# cd $wd
# mv $wd/toposat.ini ../
# find $wd/* -delete
# cd ../
# mv toposat.ini $wd
# cd $srcdir
exec > >(tee $wd/stdout.log) 2> >(tee $wd/stderr.log >&2)

#====================================================================
# Set up domain
#====================================================================
./setupDomain_points.sh $wd

#====================================================================
# Retrieve ERA data
#====================================================================
./getERA2.sh $wd

#====================================================================
# Run toposub
#====================================================================
#./runTopoSUB.sh
./makeListpoints.sh $wd

#====================================================================
# Run toposcale
#====================================================================
./runTopoSCALE.sh $wd

#====================================================================
# set up LSM
#====================================================================
./setupGeotopSim_points.sh $wd

#====================================================================
# Run LSM
#====================================================================
./runLSM.sh $wd


#====================================================================
# Validate
#====================================================================
#./validate.sh

#====================================================================
# Data assimiliataion
#====================================================================
./getMODIS_SCA.sh $wd TRUE #should be false but does not work yet


# run model
# spatialise results